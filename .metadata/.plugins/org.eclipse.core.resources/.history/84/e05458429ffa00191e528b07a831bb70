package controller;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.Statement;

/**
 * Controller class for connecting and querying to an PostgreSQL database.
 * 
 * Note: best practice is to create an connection pool for connecting and querying to database (using e.g. APACHE DBCP or c3p0), 
 * since this is a project made in short time and the amount of stress put on the database is relatively low for this case,
 * such implementations will be ignored.
 */
public class PsqlController {
	private String credentials = "jdbc:postgresql://pgserver.mah.se/rockfestival_robin_maida?user=ah2881&password=qqolpct3";

	public PsqlController() {

	}

	//MARK: INSERT Statements
	public void insertArtist(String name) {
		Connection c = null;
	      Statement stmt = null;
	      try {
	         Class.forName("org.postgresql.Driver");
	         c = DriverManager.getConnection(credentials);
	         c.setAutoCommit(false);

	         stmt = c.createStatement();
	         String sql = "INSERT INTO artist (name) "
	         		+ "VALUES ('"+name+"');";
	         stmt.executeUpdate(sql);

	         stmt.close();
	         c.commit();
	         c.close();
	      } catch (Exception e) {
	         e.printStackTrace();
	         System.exit(0);
	      }
	      System.out.println("created entity in TABLE artist");
	}

	public void insertArtistInBand(String artist, String band) {

	}

	public void insertBand(String name, String country, String info, String contactPerson) {

	}

	public void insertScene(String name, String capacity, String location) {

	}
	
	public void insertSchedule(String band, String scene, String time) {
		
	}
	
	public void insertWorker(String personNbr, String name, String address) {
		
	}
	
	//MARK: UPDATE Statement
	public void updateTable(String table, String values, String where) {
		//if where = null, do without where clause, vice versa! 
	}

	//MARK: SELECT statement
	public String[] selectTable(String table, String values, String where) {
		return null;
	}

	public static void main(String[] args) {
		PsqlController c = new PsqlController();
			c.insertArtist("Herbert Munkhammar");
	}



}
